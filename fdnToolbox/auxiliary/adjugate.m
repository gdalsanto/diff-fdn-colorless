function B = adjugate(A)%adjugate - Adjugate matrix also for singular and complex matrices% With u, s, and v obtained from [u,s,v] = svd(A), it% makes use of the identity adj(A) = det(u*v')*v*adj(s)*u',% which holds even if A and s are singular.%% Syntax:  B = adjugate(A)%% Inputs:%    A - square matrix A, and is valid even if A is singular or complex-valued%% Outputs:%    B - Adjugate matrix of A%% Example: %    B = adjugate(randn(3))%% Other m-files required: none% Subfunctions: none% MAT-files required: none%% See also: adjoint% Author: Dr.-Ing. Sebastian Jiro Schlecht, % Aalto University, Finland% email address: sebastian.schlecht@aalto.fi% Website: sebastianjiroschlecht.com% 28 December 2019; Last revision: 28 December 2019[m,n] = size(A);if (m ~= n)  error('Matrix A should be size n x n.')endif (n < 2)   B = 1;   return;end[u,s,v] = svd(A);s0 = diag(s);S0 = repmat(s0,[1 n]);S0(1:1+n:end) = 1;S = (prod(S0,1));detUV = det(u*v');B = detUV *(v.*S)*u';